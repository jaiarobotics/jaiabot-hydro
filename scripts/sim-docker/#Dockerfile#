ARG use_apt=false
FROM ubuntu:focal
ENV jaia_log_dir=/var/log/jaiabot
ENV jaia_mode=simulation
ENV USER=root
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update
RUN apt-get install -y sudo git gnupg lsb-release apt-utils vim
#items below must be installed here because ENV is not passed through sudo in the scripts below
RUN DEBIAN_FRONTEND=noninteractive TZ=Etc/UTC apt-get -y install tzdata keyboard-configuration
RUN if [[ "$use_apt" = "false" ]]; then git clone https://github.com/jaiarobotics/jaiabot.git; fi;
WORKDIR /jaiabot/scripts
RUN if [[ "$use_apt" = "false" ]]; then git switch task/add-simulator-docker-container-to-circleci/jaia-1731
RUN /jaiabot/scripts/setup-tools-build-nodocker.sh
RUN /jaiabot/scripts/setup-tools-runtime.sh
WORKDIR /jaiabot
RUN /jaiabot/build.sh
WORKDIR /jaiabot/src/python/
RUN ./build_venv.sh /jaiabot/build/web_dev/python
COPY ./entrypoint.sh /entrypoint.sh
